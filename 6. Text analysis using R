library("tm")
library("wordcloud")
install.packages("RColorBrewer")

library("RColorBrewer")
d <- read.csv("https://query.data.world/s/wmaxggxnhn4wi4jah3q73vjpvldaj6", header = TRUE,
              stringsAsFactors = FALSE, nrows = 7000)
write.table(d,"yelp.txt",sep = "\t",row.names = FALSE)
yd <- read.delim("C:/Users/DELL/Desktop/DALab/yelp.txt")
yd<-d
dat<-yd[c( "business_name", "business_categories", "text" )]
#coffee<- grep(pattern = "coffee", x = dat$business_categories, value = TRUE, ignore.case = TRUE)
coffee <- grepl("coffee", dat$business_categories, ignore.case = T)
dat<- dat[coffee, c( "business_name", "business_categories", "text")]
docs <- VCorpus(VectorSource(dat))
docs <- tm_map(docs, content_transformer(tolower))
docs <- tm_map(docs, removeNumbers)
docs <- tm_map(docs, removeWords, stopwords("english"))
docs <- tm_map(docs, stripWhitespace)
stemmed.docs<- tm_map(docs, stemDocument)
dtm <- TermDocumentMatrix(stemmed.docs) 
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE) 
d <- data.frame(word = names(v),freq=v)
wordcloud(words = d$word,freq = d$freq,min.freq = 1,max.words = 20,random.order = FALSE,rot.per = 0.35,scale = c(2,0.5),colors = brewer.pal(8,"Dark2") )

